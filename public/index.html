<html>
<head>
  <meta charset="UTF-8" />
  <title>Media Collection Tracker</title>
  <style>
    body {
      font-family: Arial, sans-serif;
      margin: 30px;
      background: #3d3dbf;
    }
    h1 {
      margin-bottom: 10px;
    }
    section {
      background: #fff;
      padding: 15px;
      margin-bottom: 20px;
      border-radius: 6px;
      box-shadow: 0 0 5px rgba(0,0,0,0.1);
    }
    input, select, button {
      margin: 5px 0;
      padding: 6px;
      width: 100%;
    }
    button {
      cursor: pointer;
    }
    pre {
      background: #111;
      color: #0f0;
      padding: 10px;
      overflow-x: auto;
    }
  </style>
</head>
<body>

<h1>ðŸ“š Media Collection Tracker</h1>
<p>Simple frontend for Collection Microservice</p>

<section>
  <h3>Get User Collection</h3>
  <input id="getUserId" type="number" placeholder="User ID" value="1">
  <button onclick="getCollection()">Fetch Collection</button>
</section>

<section>
  <h3>Add Item</h3>
  <input id="addUserId" type="number" placeholder="User ID" value="1">
  <input id="itemId" placeholder="Item ID">
  <select id="mediaType">
    <option value="anime">Anime</option>
    <option value="manga">Manga</option>
    <option value="movie">Movie</option>
    <option value="series">Series</option>
    <option value="game">Game</option>
  </select>
  <input id="source" placeholder="Source (anilist, mal, tmdb)">
  <button onclick="addItem()">Add Item</button>
</section>

<section>
  <h3>Update Progress</h3>
  <input id="updUserId" type="number" placeholder="User ID" value="1">
  <input id="updItemId" placeholder="Item ID">
  <select id="updMediaType">
    <option value="anime">Anime</option>
    <option value="manga">Manga</option>
    <option value="movie">Movie</option>
  </select>
  <input id="progress" type="number" placeholder="Progress">
  <button onclick="updateProgress()">Update</button>
</section>

<section>
  <h3>Remove Item</h3>
  <input id="delUserId" type="number" placeholder="User ID" value="1">
  <input id="delItemId" placeholder="Item ID">
  <select id="delMediaType">
    <option value="anime">Anime</option>
    <option value="manga">Manga</option>
    <option value="movie">Movie</option>
  </select>
  <button onclick="removeItem()">Remove</button>
</section>

<section>
  <h3>API Response</h3>
  <pre id="output">Waiting for action...</pre>
</section>

<script>
  function showOutput(data) {
    document.getElementById("output").textContent =
      JSON.stringify(data, null, 2);
  }

  async function getCollection() {
    const userId = document.getElementById("getUserId").value;
    const res = await fetch(`collection/${userId}`);
    showOutput(await res.json());
  }

  async function addItem() {
    const body = {
      userId: Number(document.getElementById("addUserId").value),
      itemId: document.getElementById("itemId").value,
      mediaType: document.getElementById("mediaType").value,
      source: document.getElementById("source").value
    };

    const res = await fetch(`collection/add`, {
      method: "POST",
      headers: { "Content-Type": "application/json" },
      body: JSON.stringify(body)
    });

    showOutput(await res.json());
  }

  async function updateProgress() {
    const body = {
      userId: Number(document.getElementById("updUserId").value),
      itemId: document.getElementById("updItemId").value,
      mediaType: document.getElementById("updMediaType").value,
      progress: Number(document.getElementById("progress").value)
    };

    const res = await fetch(`collection/update`, {
      method: "PATCH",
      headers: { "Content-Type": "application/json" },
      body: JSON.stringify(body)
    });

    showOutput(await res.json());
  }

  async function removeItem() {
    const body = {
      userId: Number(document.getElementById("delUserId").value),
      itemId: document.getElementById("delItemId").value,
      mediaType: document.getElementById("delMediaType").value
    };

    const res = await fetch(`collection/remove`, {
      method: "DELETE",
      headers: { "Content-Type": "application/json" },
      body: JSON.stringify(body)
    });

    showOutput(await res.json());
  }
</script>

</body>
</html>
